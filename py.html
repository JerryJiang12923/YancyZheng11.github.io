<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>钉钉机器人</title>
</head>
<body>
<py-script>
import requests
import json
import random
import os
import socket
# 函数 gethostname() 返回当前正在执行 Python 的系统主机名
res = socket.gethostbyname(socket.gethostname())

def getDingMes():
    baseUrl = "https://oapi.dingtalk.com/robot/send?access_token=06efa50af5c4cff04396ebea132d7c95fb2444821407cf11428c47edbe87933a"

    # please set charset= utf-8
    HEADERS = {
        "Content-Type": "application/json ;charset=utf-8 "
    }

# 这里的message是你想要推送的文字消息
    message = res
    stringBody ={
        "msgtype": "text",
        "text": {"content": message},
        "at": {
                "atMobiles": ["13761384148"],
               "isAtAll":0    #@所有人 时为true，上面的atMobiles就失效了
        }
 }
    MessageBody = json.dumps(stringBody)
    result = requests.post(url=baseUrl, data=MessageBody, headers=HEADERS)
    print(result.text)

if __name__ == '__main__':
    getDingMes()

</py-script>
</body>
</html>
